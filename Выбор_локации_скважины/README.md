# Выбор локации для скважины
https://github.com/5Misha/My-Skills/tree/main/Выбор_локации_скважины

## Задача проекта 
Нам предоставлены пробы нефти в трёх регионах и их характеристики для каждой скважины. Нужно построить модель для определения региона, где добыча принесёт наибольшую прибыль, и проанализировать возможную прибыль и риски техникой Bootstrap. Это поможет выбрать лучший регион для бурения новых скважин, который будет удовлетворять условиям:
- Для обучения модели подходит только линейная регрессия (остальные — недостаточно предсказуемые).
- При разведке региона исследуют 500 точек, из которых с помощью машинного обучения выбирают 200 лучших для разработки.
- Бюджет на разработку скважин в регионе — 10 млрд рублей.
- При нынешних ценах один баррель сырья приносит 450 рублей дохода. Доход с каждой единицы продукта составляет 450 тыс. рублей, поскольку объём указан в тысячах баррелей.
- После оценки рисков нужно оставить лишь те регионы, в которых вероятность убытков меньше 2.5%. Среди них выбирают регион с наибольшей средней прибылью.

## Используемые библиотеки
import pandas as pd  
import numpy as np  
import seaborn as sns  
import matplotlib.pyplot as plt  
from sklearn.linear_model import LinearRegression  
from sklearn.model_selection import train_test_split  
from sklearn.preprocessing import StandardScaler  
from sklearn.metrics import mean_squared_error

## Используемые функции
optimize_memory_usage(df: pd.DataFrame, print_size: bool=True) - Оптимизация числовых типов данных  
analiz(df, dubli) - Вывод различной информации о таблице  
numbers_plot(df) - Функция для построения гистограмм и ящиков с усами для каждого признака  
borders(df, column) - Расчет границ выбросов  
model(df) - обучение и предсказание с помощью модели линейной регрессии  
profit(df, predict, y_test) - расчитывает прибыль скважин

## Основные этапы 
Предобработка данных  
Исследовательский анализ  
Обучение моделей  
Подготовка и расчет прибыли с рисками  

## Общий вывод  
В данном проекте мы помогли компании «ГлавРосГосНефть», которая предоставила пробы нефти в трёх регионах, с выбором из трех регионов места для бурения новой скважины. Для этого нам пришлось проделать несколько шагов. Предобоработка данных, где мы обработали данные, используя две функции: optimize_memory_usage() и analiz(). Первая помогла уменьшить затртату памяти на данные, поменяв типы float64 на float32, чтобы ускорить работу с ними. Вторая - проверила таблицы на пропуски и дубликаты. Ничего из этого не было обнаружено. Сделали исследовательский анализ, где была использована функция numbers_plot, строющая гистограммы и ящики с усами с помощью библиотеки seaborn. Далее с помощью функции model, которая обучает модель линейной регрессии, считает среднее предсказанных значений, метрику RMSE и процент разброса полученной величины от среднего предсказанного значения. Создали массив датафреймов по 500 случайных предсказанных значений с помощью Bootstrap из 1000 выборок, и с помощью функции profit считаем прибыль по 200 лучшим тестовым значениям массива. Посчитали 95%-й доверительный интервал и риск убытков. Самым оптимальным для бурения новых скважин оказался второй регион с данными из geo_data_1. Он показал лучшие результаты при использовании модели. В подготовке прибыли к расчету регион оказался с самым маленьким значением по среднему кол-ву баррелей в скважинах, но это не помешало в итоговой проверке с помощью Bootstrap и функции profit стать единственным регионом, который смог удовлетворить всем условиям компании.
