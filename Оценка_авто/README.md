# Оценка стоимости автомобилей
https://github.com/5Misha/My-Skills/blob/main/Оценка_авто/Оценка_автомобилей.ipynb 

## Задача проекта
На основе имеющихся данных требуется разработать модель, способную прогнозировать цену автомобиля на основе его характеристик. Это обеспечит удобство при продаже или покупке автомобилей и поспособствует привлечению новых клиентов

## Используемые инструменты
pandas, numpy, matplotlib.pyplot, seaborn, scipy, os    
DecisionTreeRegressor, LinearRegression, LGBMRegressor  
train_test_split, GridSearchCV    
StandardScaler, OneHotEncoder, OrdinalEncoder  
make_scorer, mean_squared_error, mean_squared_error  
cross_val_score, KFold, time  
DummyRegressor

## Используемые функции
analiz(df, cat_per) - Вывод различной информации о таблице  
optimize_memory_usage(df: pd.DataFrame, print_size: bool=True) - Оптимизация числовых типов данных
numbers_plot(df, param_hue) - Функция для построения гистограмм и ящиков с усами для каждого признака  
borders(df, column) - Функция для расчета границ выбросов  
kategory_col(df, columns) - Изображает категориальные признаки в виде столбчатых диаграмм

## Основные шаги
* Предобработка данных
* Подготовка к обучению модели
* Обучение модели

## Общий вывод
Нам удалось создать и подобрать лучшую модель для компании , которая быстро и качественно предсказывает стоймость машины пользователя. Для этого мы проделали несколько шагов:

Загрузка данных. На данном шаге мы загрузили информацию, которую нам предоставила компания «Не бит, не крашен», в виде таблицы.
Предобработка данных. Первым делом мы приведели к нижнему регистру названия столбиков и заменим слитное написание раздельных слов на _. Посмотрели на информацию, типы столбцов, пропуски и дубликаты таблицы с помощью функции analiz. Изменили типы данных у двух столбцов с датами на datetime64. С помощью функции describe() мы так же увидли информацию о таблице, но немного другую. Тут уже больше видны выбросы или какие-то нестандартные значеиня. В столбце с годом регистрации автомобиля это 9999 и 1000 годы. В мощности машины - 20000 л.с. слишком много. И самый странный столбец это number_of_pictures, его пришлось удалить, т.к. в нем были одни нули. И в самом конце шага удалили данные. Еще удалили RegistrationMonth и PostalCode
Подготовка к обучению модели. На данном шаге мы проанализировали числовые и категориальные данные с помощью функций numbers_plot и kategory_col. В численных данных пришлось удалить полтора процента оставшихся данных. Это были выбросы из 'registration_year' и 'power'. Остальные значения были не настолько критичны, чтобы их удалять, потому что выборка могла сильно уменьшиться. По категориальным значениям неявных дубликатов не было замечено.
Обучение моделей. Пришлось обучить три модели LinearRegression, DecisionTreeRegressor, LGBMRegressor. Сравнили их метрики и время обучения. Самой лучшей из них оказалась LGBMRegressor, показав лучшую метрику RMSE: 2436 на кросс-валидации, а на тестовой выборке вообще 1620, то есть предсказанная цена в среднем может отличается от истиного на 1600 и по времени, затратив на обучение и предсказание меньше секунды для каждого шага. Параметры модели: 'max_depth': 20, 'n_estimators': 100, 'num_leaves': 140. Большие значения параметров не были установлены, так как модель могла переобучиться
Итоговой моделью стал градиентный бустинг LightGBM. Ее мы проверили на тестовой выборке и с помощью DummyRegressor. Везде получились хорошие результаты. Она удовлетворяет всем условиям заказчика, благодаря своей метрике, рассчитывая стоймость автомобиля пользователя примерно за 12 секунд на тестовой выборке. Пока будет идти подсчет цены авто пользователя, то ему можно предложить посмотреть цены на похожие на его машины.
